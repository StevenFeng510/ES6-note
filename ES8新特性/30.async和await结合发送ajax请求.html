<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <script>
            // 发送 AJAX请求, 返回的结果是Promise 对象  promise 封装
            function sendAJAX(url) {
                return new Promise((resolve, reject) => {
                    // 1. 创建对象
                    const xhr = new XMLHttpRequest();

                    // 2. 初始化
                    xhr.open('GET', url);

                    // 3. 发送
                    xhr.send();

                    // 4. 事件绑定
                    xhr.onreadystatechange = () => {
                        if (xhr.readyState === 4) {
                            if (xhr.status >= 200 && xhr.status <= 300) {
                                // 成功
                                resolve(xhr.response);
                            } else {
                                // 失败
                                reject(x.status);
                            }
                        }
                    };
                });
            }

            // Promise then 方法测试
            // const res = sendAJAX('https://api.apiopen.top/getJoke').then((value) => {
            //     console.log(value);
            // });

            // console.log(res);

            // async发请求 与 await接结果 测试  axios
            async function main() {
                // 发送请求
                let res = await sendAJAX('https://api.apiopen.top/getJoke');
                console.log(res);
            }

            main();
        </script>
    </body>
</html>
